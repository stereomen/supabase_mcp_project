<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>get-weather-tide-data API ê²€ì¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 90%;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: visible;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .header p {
            font-size: 1em;
            opacity: 0.9;
        }
        .content {
            padding: 20px;
        }
        .form-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .form-group small {
            color: #666;
            margin-top: 5px;
            font-size: 0.85em;
        }
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .tabs {
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        .tab {
            padding: 12px 30px;
            background: transparent;
            border: none;
            border-radius: 8px 8px 0 0;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s;
            color: #666;
        }
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .sub-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        .sub-tab {
            padding: 8px 20px;
            background: transparent;
            border: none;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
            border-bottom: 2px solid transparent;
        }
        .sub-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }
        .sub-tab-content {
            display: none;
        }
        .sub-tab-content.active {
            display: block;
        }
        .formatted-text {
            background: #f8f9fa;
            color: #000000;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.8;
            white-space: pre-wrap;
        }
        /* í”Œë¡œíŒ… ë²„íŠ¼ */
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }
        .scroll-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .scroll-to-top.show {
            display: flex;
        }
        /* ìŠ¤í‹°í‚¤ ë„¤ë¹„ê²Œì´ì…˜ */
        .sticky-nav {
            position: sticky;
            top: 0;
            background: white;
            border-bottom: 2px solid #667eea;
            padding: 10px 15px;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: -15px -15px 15px -15px;
            overflow-x: auto;
            white-space: nowrap;
        }
        .sticky-nav::-webkit-scrollbar {
            height: 4px;
        }
        .sticky-nav::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .sticky-nav::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 2px;
        }
        .nav-item {
            display: inline-block;
            padding: 8px 15px;
            margin-right: 10px;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
            color: #333;
        }
        .nav-item:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }
        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
        }
        /* ì„¹ì…˜ êµ¬ë¶„ */
        .data-section {
            scroll-margin-top: 80px;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            margin-bottom: 15px;
        }
        .section-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            margin: 0;
        }
        .section-toggle {
            font-size: 1.2em;
            transition: transform 0.3s;
        }
        .section-toggle.collapsed {
            transform: rotate(-90deg);
        }
        .section-content {
            display: block;
        }
        .section-content.collapsed {
            display: none;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .result-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
        }
        .json-viewer {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .json-viewer .string { color: #8bc34a; } /* Light green */
        .json-viewer .number { color: #f9c74f; } /* Yellow */
        .json-viewer .boolean { color: #6a05ad; } /* Purple */
        .json-viewer .null { color: #d63384; } /* Pink */
        .json-viewer .key { color: #5dade2; } /* Light blue */
        .field-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .field-table th,
        .field-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        .field-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        .field-table tr:hover {
            background: #f5f5f5;
        }
        .section-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        .section-title:first-child {
            margin-top: 0;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        .error {
            background: #fee;
            color: #c33;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #c33;
        }
        .success {
            background: #efe;
            color: #3c3;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3c3;
            margin-bottom: 20px;
        }
        .api-info {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: #0066cc;
        }
        .back-button {
            background: #6c757d;
            padding: 10px 20px;
            font-size: 0.9em;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                max-width: 100%;
            }
            .content {
                padding: 10px;
            }
            .form-section {
                padding: 15px;
            }
            .result-section {
                padding: 10px;
            }
            .json-viewer, .formatted-text {
                padding: 10px;
                font-size: 0.85em;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
            .tabs {
                flex-direction: column;
            }
            .tab {
                border-radius: 8px;
            }
        }
    </style>

    <!-- Supabase ì„¤ì • (ì¸ë¼ì¸) -->
    <script>
    const SUPABASE_CONFIG = {
        url: 'https://iwpgvdtfpwazzfeniusk.supabase.co',
        anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3cGd2ZHRmcHdhenpmZW5pdXNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEwNzEzOTQsImV4cCI6MjA2NjY0NzM5NH0.d0pjIvnOdPGbc_-cfqRNu9yOIutyO1eex848k1yNZJE'
    };
    </script>

    <!-- ê³µí†µ ê´€ì¸¡ì†Œ ëª©ë¡ ë°ì´í„° -->
    <script src="shared/locations.js"></script>

    <!-- ê´€ë¦¬ì ì¸ì¦ ì²´í¬ -->
    <script src="_shared/auth-check.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â›µ API ê²€ì¦ ë„êµ¬</h1>
            <p>ë‹¤ì–‘í•œ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³  ì‘ë‹µ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
        </div>

        <div class="content">
            <button class="back-button" onclick="window.location.href='index.html'">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</button>

            <div class="form-section">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="apiSelect">í…ŒìŠ¤íŠ¸í•  API ì„ íƒ *</label>
                    <select id="apiSelect" onchange="updateFormFields()" style="font-size: 1.1em; padding: 15px;">
                        <option value="get-weather-tide-data">ğŸŒŠ get-weather-tide-data (ë‚ ì”¨+ì¡°ì„ í†µí•© API)</option>
                        <option value="get-ad-weather-data">ğŸ¯ get-ad-weather-data (ê´‘ê³  í¬í•¨ ë‚ ì”¨ API)</option>
                        <option value="manage-ad-repo">ğŸ“‹ manage-ad-repo (ê´‘ê³  ìº í˜ì¸ ê´€ë¦¬)</option>
                        <option value="partner-auth">ğŸ” partner-auth (ì œíœ´ì‚¬ ì¸ì¦)</option>
                        <option value="track-ad-event">ğŸ“Š track-ad-event (ê´‘ê³  ì´ë²¤íŠ¸ ì¶”ì )</option>
                    </select>
                </div>

                <div class="api-info" id="apiInfo">
                    <strong>API ì—”ë“œí¬ì¸íŠ¸:</strong> <span id="apiEndpoint">https://iwpgvdtfpwazzfeniusk.supabase.co/functions/v1/get-weather-tide-data</span>
                </div>

                <!-- Weather/Ad API Form -->
                <div id="weatherForm" class="form-grid">
                    <div class="form-group">
                        <label for="locationCode">ê´€ì¸¡ì†Œ ì½”ë“œ *</label>
                        <select id="locationCode" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        </select>
                        <small>ë°ì´í„°ë¥¼ ì¡°íšŒí•  ê´€ì¸¡ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”</small>
                    </div>

                    <div class="form-group">
                        <label for="date">ë‚ ì§œ *</label>
                        <input type="date" id="date" required>
                        <small>ì¡°íšŒ ì‹œì‘ ë‚ ì§œ (YYYY-MM-DD)</small>
                    </div>

                    <div class="form-group">
                        <label for="time">ì‹œê°„ (ì„ íƒì‚¬í•­)</label>
                        <input type="time" id="time" placeholder="HH:MM">
                        <small>íŠ¹ì • ì‹œê° ì¡°íšŒ ì‹œ ì…ë ¥ (í•´ì–‘ ê´€ì¸¡ ë°ì´í„°ë§Œ í•´ë‹¹)</small>
                    </div>
                </div>

                <!-- Ad Repo Management Form -->
                <div id="adRepoForm" class="form-grid" style="display: none;">
                    <div class="form-group">
                        <label for="adAction">ì‘ì—… ì„ íƒ *</label>
                        <select id="adAction" onchange="updateAdFormFields()">
                            <option value="list">list (ì „ì²´ ìº í˜ì¸ ëª©ë¡)</option>
                            <option value="get">get (íŠ¹ì • ìº í˜ì¸ ì¡°íšŒ)</option>
                            <option value="list_partners">list_partners (ì œíœ´ì‚¬ ëª©ë¡)</option>
                            <option value="get_active">get_active (í™œì„± ìº í˜ì¸)</option>
                        </select>
                    </div>

                    <div class="form-group" id="adIdGroup" style="display: none;">
                        <label for="adId">ìº í˜ì¸ UUID *</label>
                        <input type="text" id="adId" placeholder="550e8400-e29b-41d4-a716-446655440000">
                        <small>íŠ¹ì • ìº í˜ì¸ ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ ì‹œ í•„ìš”</small>
                    </div>

                    <div class="form-group" id="stationIdGroup" style="display: none;">
                        <label for="adStationId">ê´€ì¸¡ì†Œ ì½”ë“œ</label>
                        <input type="text" id="adStationId" placeholder="DT_0001" value="DT_0001">
                        <small>í™œì„± ìº í˜ì¸ ì¡°íšŒ ì‹œ ì‚¬ìš© (ì„ íƒì‚¬í•­)</small>
                    </div>
                </div>

                <!-- Partner Auth Form -->
                <div id="authForm" class="form-grid" style="display: none;">
                    <div class="form-group">
                        <label for="authAction">ì‘ì—… ì„ íƒ *</label>
                        <select id="authAction">
                            <option value="login">login (ë¡œê·¸ì¸)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="partnerId">ì—…ì²´ ID *</label>
                        <input type="text" id="partnerId" placeholder="PARTNER_001">
                    </div>

                    <div class="form-group">
                        <label for="password">ë¹„ë°€ë²ˆí˜¸ *</label>
                        <input type="password" id="password">
                    </div>
                </div>

                <!-- Track Event Form -->
                <div id="trackForm" class="form-grid" style="display: none;">
                    <div class="form-group">
                        <label for="eventAdId">ê´‘ê³  ìº í˜ì¸ ID *</label>
                        <input type="text" id="eventAdId" placeholder="UUID" required>
                    </div>

                    <div class="form-group">
                        <label for="eventType">ì´ë²¤íŠ¸ íƒ€ì… *</label>
                        <select id="eventType">
                            <option value="impression">impression (ë…¸ì¶œ)</option>
                            <option value="click">click (í´ë¦­)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="eventStationId">ê´€ì¸¡ì†Œ ID (ì„ íƒ)</label>
                        <input type="text" id="eventStationId" placeholder="DT_0001">
                    </div>
                </div>

                <div class="button-group">
                    <button id="fetchBtn" onclick="fetchData()">ğŸ” ë°ì´í„° ì¡°íšŒ</button>
                    <button onclick="clearResults()">ğŸ—‘ï¸ ê²°ê³¼ ì´ˆê¸°í™”</button>
                </div>
            </div>

            <div id="resultContainer" style="display: none;">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('raw')">ğŸ“„ Raw JSON</button>
                    <button class="tab" onclick="switchTab('fields')">ğŸ“‹ í•„ë“œ ì„¤ëª…</button>
                </div>

                <div class="result-section">
                    <div id="rawTab" class="tab-content active">
                        <div class="sub-tabs">
                            <button class="sub-tab active" onclick="switchSubTab('json')">JSON</button>
                            <button class="sub-tab" onclick="switchSubTab('formatted')">ì •ë¦¬ëœ í…ìŠ¤íŠ¸</button>
                        </div>

                        <div id="jsonSubTab" class="sub-tab-content active">
                            <div id="jsonViewer"></div>
                        </div>

                        <div id="formattedSubTab" class="sub-tab-content">
                            <div class="formatted-text" id="formattedViewer"></div>
                        </div>
                    </div>

                    <div id="fieldsTab" class="tab-content">
                        <div id="fieldsViewer"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë§¨ ìœ„ë¡œ ë²„íŠ¼ -->
    <button class="scroll-to-top" id="scrollToTop" onclick="scrollToTop()">â†‘</button>

    <script>
        // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ - ë§¨ ìœ„ë¡œ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
        window.addEventListener('scroll', function() {
            const scrollBtn = document.getElementById('scrollToTop');
            if (window.pageYOffset > 300) {
                scrollBtn.classList.add('show');
            } else {
                scrollBtn.classList.remove('show');
            }

            // í˜„ì¬ ë³´ê³  ìˆëŠ” ì„¹ì…˜ í•˜ì´ë¼ì´íŠ¸
            updateActiveNavItem();
        });

        // ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // í˜„ì¬ ë³´ê³  ìˆëŠ” ì„¹ì…˜ì˜ ë„¤ë¹„ê²Œì´ì…˜ ì•„ì´í…œ í™œì„±í™”
        function updateActiveNavItem() {
            const sections = document.querySelectorAll('.data-section');
            const navItems = document.querySelectorAll('.nav-item');

            let currentSection = '';
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) {
                    currentSection = section.id;
                }
            });

            navItems.forEach(item => {
                if (item.getAttribute('data-target') === currentSection) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // ì„¹ì…˜ í† ê¸€
        function toggleSection(sectionId) {
            const content = document.querySelector(`#${sectionId} .section-content`);
            const toggle = document.querySelector(`#${sectionId} .section-toggle`);

            if (content && toggle) {
                content.classList.toggle('collapsed');
                toggle.classList.toggle('collapsed');
            }
        }
    </script>

    <script>
        // ê´€ì¸¡ì†Œ ëª©ë¡: shared/locations.jsì—ì„œ ë¡œë“œë¨ (ì´ 178ê°œ)

        // Initialize
        window.onload = function() {
            // Populate location select with sorted locations
            const select = document.getElementById('locationCode');

            // Sort locations by code in ascending order
            const sortedLocations = [...locations].sort((a, b) => a.code.localeCompare(b.code));

            sortedLocations.forEach(loc => {
                const option = document.createElement('option');
                option.value = loc.code;
                option.textContent = `${loc.code} - ${loc.name}`;
                select.appendChild(option);
            });

            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;

            // Set default location to DT_0058 (ê²½ì¸í•­)
            document.getElementById('locationCode').value = 'DT_0058';
        };

        let currentData = null;
        const ANON_KEY = SUPABASE_CONFIG.anonKey;
        const BASE_URL = `${SUPABASE_CONFIG.url}/functions/v1`;

        function updateFormFields() {
            const apiSelect = document.getElementById('apiSelect').value;
            const apiEndpoint = document.getElementById('apiEndpoint');

            // Hide all forms
            document.getElementById('weatherForm').style.display = 'none';
            document.getElementById('adRepoForm').style.display = 'none';
            document.getElementById('authForm').style.display = 'none';
            document.getElementById('trackForm').style.display = 'none';

            // Show relevant form and update endpoint
            switch(apiSelect) {
                case 'get-weather-tide-data':
                    document.getElementById('weatherForm').style.display = 'grid';
                    apiEndpoint.textContent = `${BASE_URL}/get-weather-tide-data`;
                    break;
                case 'get-ad-weather-data':
                    document.getElementById('weatherForm').style.display = 'grid';
                    apiEndpoint.textContent = `${BASE_URL}/get-ad-weather-data`;
                    break;
                case 'manage-ad-repo':
                    document.getElementById('adRepoForm').style.display = 'grid';
                    apiEndpoint.textContent = `${BASE_URL}/manage-ad-repo`;
                    updateAdFormFields(); // ì´ˆê¸° í•„ë“œ ìƒíƒœ ì„¤ì •
                    break;
                case 'partner-auth':
                    document.getElementById('authForm').style.display = 'grid';
                    apiEndpoint.textContent = `${BASE_URL}/partner-auth`;
                    break;
                case 'track-ad-event':
                    document.getElementById('trackForm').style.display = 'grid';
                    apiEndpoint.textContent = `${BASE_URL}/track-ad-event`;
                    break;
            }
        }

        function updateAdFormFields() {
            const action = document.getElementById('adAction').value;
            const adIdGroup = document.getElementById('adIdGroup');
            const stationIdGroup = document.getElementById('stationIdGroup');

            // ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë‘ ìˆ¨ê¹€
            adIdGroup.style.display = 'none';
            stationIdGroup.style.display = 'none';

            // actionì— ë”°ë¼ í•„ìš”í•œ í•„ë“œë§Œ í‘œì‹œ
            switch(action) {
                case 'get':
                case 'update':
                case 'delete':
                    adIdGroup.style.display = 'block';
                    break;
                case 'get_active':
                    stationIdGroup.style.display = 'block';
                    break;
                case 'list':
                case 'list_partners':
                    // ì•„ë¬´ í•„ë“œë„ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                    break;
            }
        }

        async function fetchData() {
            const apiSelect = document.getElementById('apiSelect').value;
            const fetchBtn = document.getElementById('fetchBtn');

            fetchBtn.disabled = true;
            fetchBtn.textContent = 'â³ ì¡°íšŒ ì¤‘...';

            try {
                let url, options;

                switch(apiSelect) {
                    case 'get-weather-tide-data':
                    case 'get-ad-weather-data':
                        const code = document.getElementById('locationCode').value;
                        const date = document.getElementById('date').value;
                        const timeInput = document.getElementById('time').value;

                        if (!code || !date) {
                            alert('ê´€ì¸¡ì†Œ ì½”ë“œì™€ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                            return;
                        }

                        const time = timeInput ? timeInput.replace(':', '') : '';
                        url = `${BASE_URL}/${apiSelect}?code=${code}&date=${date}`;
                        if (time) url += `&time=${time}`;

                        options = {
                            method: 'GET',
                            headers: getAuthHeaders()
                        };
                        break;

                    case 'manage-ad-repo':
                        const action = document.getElementById('adAction').value;
                        const adId = document.getElementById('adId').value;
                        const adStationId = document.getElementById('adStationId').value;

                        // UUIDê°€ í•„ìš”í•œ actionì¸ì§€ í™•ì¸
                        const actionsNeedingId = ['get', 'update', 'delete'];
                        if (actionsNeedingId.includes(action) && !adId) {
                            alert(`âŒ ${action} ì‘ì—…ì—ëŠ” ìº í˜ì¸ UUIDê°€ í•„ìš”í•©ë‹ˆë‹¤.\n\në¨¼ì € "list" ì•¡ì…˜ìœ¼ë¡œ ìº í˜ì¸ ëª©ë¡ì„ ì¡°íšŒí•œ í›„,\nìº í˜ì¸ ID(UUID)ë¥¼ ë³µì‚¬í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.`);
                            return;
                        }

                        const body = { action };
                        if (adId) {
                            body.id = adId;
                        }
                        if (action === 'get_active' && adStationId) {
                            body.station_id = adStationId;
                        }

                        url = `${BASE_URL}/manage-ad-repo`;
                        options = {
                            method: 'POST',
                            headers: getAuthHeaders(),
                            body: JSON.stringify(body)
                        };
                        break;

                    case 'partner-auth':
                        const authAction = document.getElementById('authAction').value;
                        const partnerId = document.getElementById('partnerId').value;
                        const password = document.getElementById('password').value;

                        if (!partnerId || !password) {
                            alert('ì—…ì²´ IDì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                            return;
                        }

                        url = `${BASE_URL}/partner-auth`;
                        options = {
                            method: 'POST',
                            headers: getAuthHeaders(),
                            body: JSON.stringify({
                                action: authAction,
                                partner_id: partnerId,
                                password: password
                            })
                        };
                        break;

                    case 'track-ad-event':
                        const eventAdId = document.getElementById('eventAdId').value;
                        const eventType = document.getElementById('eventType').value;
                        const eventStationId = document.getElementById('eventStationId').value;

                        if (!eventAdId) {
                            alert('ê´‘ê³  ìº í˜ì¸ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                            return;
                        }

                        url = `${BASE_URL}/track-ad-event`;
                        options = {
                            method: 'POST',
                            headers: getAuthHeaders(),
                            body: JSON.stringify({
                                ad_repo_id: eventAdId,
                                event_type: eventType,
                                station_id: eventStationId || null
                            })
                        };
                        break;
                }

                const response = await fetch(url, options);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                currentData = await response.json();
                displayResults();

            } catch (error) {
                document.getElementById('resultContainer').style.display = 'block';
                document.getElementById('rawTab').innerHTML = `
                    <div class="error">
                        <strong>âš ï¸ ì˜¤ë¥˜ ë°œìƒ:</strong><br>
                        ${error.message}
                    </div>
                `;
            } finally {
                fetchBtn.disabled = false;
                fetchBtn.textContent = 'ğŸ” ë°ì´í„° ì¡°íšŒ';
            }
        }

        function displayResults() {
            document.getElementById('resultContainer').style.display = 'block';

            // Display raw JSON with sticky navigation
            document.getElementById('jsonViewer').innerHTML = formatJSONWithNavigation(currentData);

            // Display formatted HTML with sections
            document.getElementById('formattedViewer').innerHTML = formatDataAsHTML(currentData);

            // Display field descriptions
            displayFieldDescriptions();
        }

        function displayFieldDescriptions() {
            const fieldsViewer = document.getElementById('fieldsViewer');

            let html = '<div class="success">âœ… ë°ì´í„° ì¡°íšŒ ì™„ë£Œ</div>';

            // Ad Data (for get-ad-weather-data API)
            if (currentData.ads && currentData.ads.length > 0) {
                html += `
                    <div class="section-title">ğŸ¯ ads (ê´‘ê³  ë°ì´í„° - ${currentData.ads.length}ê°œ)</div>
                    <p style="margin-bottom: 15px; color: #666;">ìš°ì„ ìˆœìœ„ ìˆœìœ¼ë¡œ ì •ë ¬ëœ í™œì„± ê´‘ê³  ëª©ë¡</p>
                `;

                currentData.ads.forEach((ad, index) => {
                    html += `
                    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4 style="margin-bottom: 10px; color: #667eea;">ê´‘ê³  #${index + 1} (ìš°ì„ ìˆœìœ„: ${ad.priority})</h4>
                        <table class="field-table">
                            <thead>
                                <tr>
                                    <th>í•„ë“œëª…</th>
                                    <th>ì„¤ëª…</th>
                                    <th>ê°’</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>id</td><td>ìº í˜ì¸ ID</td><td>${ad.id || '-'}</td></tr>
                                <tr><td>campaign_name</td><td>ìº í˜ì¸ëª…</td><td>${ad.campaign_name || '-'}</td></tr>
                                <tr><td>partner_id</td><td>ì œíœ´ì‚¬ ID</td><td>${ad.partner_id || '-'}</td></tr>
                                <tr><td>partner_name</td><td>ì œíœ´ì‚¬ëª…</td><td>${ad.partner_name || '-'}</td></tr>
                                <tr><td>matched_station_id</td><td>ë§¤ì¹­ ê´€ì¸¡ì†Œ</td><td>${ad.matched_station_id && Array.isArray(ad.matched_station_id) && ad.matched_station_id.length > 0 ? ad.matched_station_id.join(', ') : 'ì „ì²´'}</td></tr>
                                <tr><td>matched_area</td><td>ë§¤ì¹­ í•´ì—­</td><td>${ad.matched_area || 'ì „ì²´'}</td></tr>
                                <tr><td>ad_type_a</td><td>ê´‘ê³  íƒ€ì… A</td><td>${ad.ad_type_a || '-'}</td></tr>
                                <tr><td>ad_type_b</td><td>ê´‘ê³  íƒ€ì… B</td><td>${ad.ad_type_b || '-'}</td></tr>
                                <tr><td>image_a_url</td><td>ì´ë¯¸ì§€ A URL</td><td>${ad.image_a_url || '-'}</td></tr>
                                <tr><td>image_b_url</td><td>ì´ë¯¸ì§€ B URL</td><td>${ad.image_b_url || '-'}</td></tr>
                                <tr><td>landing_url</td><td>ëœë”© í˜ì´ì§€ URL</td><td>${ad.landing_url || '-'}</td></tr>
                                <tr><td>priority</td><td>ìš°ì„ ìˆœìœ„</td><td>${ad.priority || 0}</td></tr>
                                <tr><td>business_type</td><td>ì—…ì¢…</td><td>${ad.business_type || '-'}</td></tr>
                                <tr><td>business_level</td><td>ì‚¬ì—…ì ë“±ê¸‰</td><td>${ad.business_level || '-'}</td></tr>
                            </tbody>
                        </table>
                    </div>
                    `;
                });
            } else if (document.getElementById('apiSelect').value === 'get-ad-weather-data') {
                html += `
                    <div class="section-title">ğŸ¯ ads (ê´‘ê³  ë°ì´í„°)</div>
                    <p style="margin-bottom: 15px; color: #999;">í˜„ì¬ ì¡°ê±´ì— ë§ëŠ” í™œì„± ê´‘ê³ ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                `;
            }

            // Weather Forecasts
            if (currentData.weather_forecasts && currentData.weather_forecasts.length > 0) {
                html += `
                    <div class="section-title">â˜ï¸ weather_forecasts (ê¸°ìƒì²­ ë‹¨ê¸° ì˜ˆë³´ - 3ì¼ì¹˜)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.weather_forecasts.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>fcst_datetime_kr</td><td>ì˜ˆë³´ ì‹œê° (KST)</td><td>${currentData.weather_forecasts[0].fcst_datetime_kr || '-'}</td></tr>
                            <tr><td>tmp</td><td>ê¸°ì˜¨ (Â°C)</td><td>${currentData.weather_forecasts[0].tmp || '-'}</td></tr>
                            <tr><td>tmn</td><td>ìµœì € ê¸°ì˜¨ (Â°C)</td><td>${currentData.weather_forecasts[0].tmn || '-'}</td></tr>
                            <tr><td>tmx</td><td>ìµœê³  ê¸°ì˜¨ (Â°C)</td><td>${currentData.weather_forecasts[0].tmx || '-'}</td></tr>
                            <tr><td>uuu</td><td>í’ì† ë™ì„œì„±ë¶„ (m/s)</td><td>${currentData.weather_forecasts[0].uuu || '-'}</td></tr>
                            <tr><td>vvv</td><td>í’ì† ë‚¨ë¶ì„±ë¶„ (m/s)</td><td>${currentData.weather_forecasts[0].vvv || '-'}</td></tr>
                            <tr><td>vec</td><td>í’í–¥ (ë„)</td><td>${currentData.weather_forecasts[0].vec || '-'}</td></tr>
                            <tr><td>wsd</td><td>í’ì† (m/s)</td><td>${currentData.weather_forecasts[0].wsd || '-'}</td></tr>
                            <tr><td>sky</td><td>í•˜ëŠ˜ ìƒíƒœ (1:ë§‘ìŒ, 3:êµ¬ë¦„ë§ìŒ, 4:íë¦¼)</td><td>${currentData.weather_forecasts[0].sky || '-'}</td></tr>
                            <tr><td>pty</td><td>ê°•ìˆ˜ í˜•íƒœ (0:ì—†ìŒ, 1:ë¹„, 2:ë¹„/ëˆˆ, 3:ëˆˆ)</td><td>${currentData.weather_forecasts[0].pty || '-'}</td></tr>
                            <tr><td>pop</td><td>ê°•ìˆ˜ í™•ë¥  (%)</td><td>${currentData.weather_forecasts[0].pop || '-'}</td></tr>
                            <tr><td>wav</td><td>íŒŒê³  (m)</td><td>${currentData.weather_forecasts[0].wav || '-'}</td></tr>
                            <tr><td>pcp</td><td>1ì‹œê°„ ê°•ìˆ˜ëŸ‰ (mm)</td><td>${currentData.weather_forecasts[0].pcp || '-'}</td></tr>
                            <tr><td>reh</td><td>ìŠµë„ (%)</td><td>${currentData.weather_forecasts[0].reh || '-'}</td></tr>
                            <tr><td>sno</td><td>1ì‹œê°„ ì‹ ì ì„¤ (cm)</td><td>${currentData.weather_forecasts[0].sno || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // Tide Data
            if (currentData.tide_data && currentData.tide_data.length > 0) {
                html += `
                    <div class="section-title">ğŸŒŠ tide_data (ì¡°ì„ ë°ì´í„° - 14ì¼ì¹˜)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.tide_data.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>obs_date</td><td>ê´€ì¸¡ ë‚ ì§œ (YYYY-MM-DD)</td><td>${currentData.tide_data[0].obs_date || '-'}</td></tr>
                            <tr><td>lvl1</td><td>1ì°¨ ì¡°ì„ ì‹œê° ë° ë†’ì´</td><td>${currentData.tide_data[0].lvl1 || '-'}</td></tr>
                            <tr><td>lvl2</td><td>2ì°¨ ì¡°ì„ ì‹œê° ë° ë†’ì´</td><td>${currentData.tide_data[0].lvl2 || '-'}</td></tr>
                            <tr><td>lvl3</td><td>3ì°¨ ì¡°ì„ ì‹œê° ë° ë†’ì´</td><td>${currentData.tide_data[0].lvl3 || '-'}</td></tr>
                            <tr><td>lvl4</td><td>4ì°¨ ì¡°ì„ ì‹œê° ë° ë†’ì´</td><td>${currentData.tide_data[0].lvl4 || '-'}</td></tr>
                            <tr><td>date_sun</td><td>ì¼ì¶œ/ì¼ëª° ì‹œê°</td><td>${currentData.tide_data[0].date_sun || '-'}</td></tr>
                            <tr><td>date_moon</td><td>ì›”ì¶œ/ì›”ëª° ì‹œê°</td><td>${currentData.tide_data[0].date_moon || '-'}</td></tr>
                            <tr><td>mool_normal</td><td>ë¬¼ë•Œ (ì¡°ì„ ì£¼ê¸°)</td><td>${currentData.tide_data[0].mool_normal || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // Marine Observations A
            if (currentData.marine_observations && currentData.marine_observations.a && currentData.marine_observations.a.length > 0) {
                html += `
                    <div class="section-title">ğŸŒŠ marine_observations.a (í•´ì–‘ ê´€ì¸¡ A - ìˆ˜ì˜¨/íŒŒê³ )</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.marine_observations.a.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>station_id</td><td>ê´€ì¸¡ì†Œ ID</td><td>${currentData.marine_observations.a[0].station_id || '-'}</td></tr>
                            <tr><td>observation_time_kst</td><td>ê´€ì¸¡ ì‹œê° (KST, YYYYMMDDHHmm)</td><td>${currentData.marine_observations.a[0].observation_time_kst || '-'}</td></tr>
                            <tr><td>water_temperature</td><td>ìˆ˜ì˜¨ (Â°C)</td><td>${currentData.marine_observations.a[0].water_temperature || '-'}</td></tr>
                            <tr><td>significant_wave_height</td><td>ìœ ì˜íŒŒê³  (m)</td><td>${currentData.marine_observations.a[0].significant_wave_height || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // Marine Observations B
            if (currentData.marine_observations && currentData.marine_observations.b && currentData.marine_observations.b.length > 0) {
                html += `
                    <div class="section-title">ğŸŒ¬ï¸ marine_observations.b (í•´ì–‘ ê´€ì¸¡ B - ê¸°ìƒ)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.marine_observations.b.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>station_id</td><td>ê´€ì¸¡ì†Œ ID</td><td>${currentData.marine_observations.b[0].station_id || '-'}</td></tr>
                            <tr><td>observation_time_kst</td><td>ê´€ì¸¡ ì‹œê° (KST, YYYYMMDDHHmm)</td><td>${currentData.marine_observations.b[0].observation_time_kst || '-'}</td></tr>
                            <tr><td>air_temperature</td><td>ê¸°ì˜¨ (Â°C)</td><td>${currentData.marine_observations.b[0].air_temperature || '-'}</td></tr>
                            <tr><td>wind_direction</td><td>í’í–¥ (ë„)</td><td>${currentData.marine_observations.b[0].wind_direction || '-'}</td></tr>
                            <tr><td>wind_speed</td><td>í’ì† (m/s)</td><td>${currentData.marine_observations.b[0].wind_speed || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // Marine (medium-term marine forecast)
            if (currentData.marine && currentData.marine.length > 0) {
                html += `
                    <div class="section-title">ğŸŒŠ marine (ì¤‘ê¸° í•´ìƒ ì˜ˆë³´ - 4~11ì¼ì§¸)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.marine.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>tm_ef_kr</td><td>ì˜ˆë³´ ìœ íš¨ ì‹œê° (KST)</td><td>${currentData.marine[0].tm_ef_kr || '-'}</td></tr>
                            <tr><td>reg_id</td><td>ì§€ì—­ ID</td><td>${currentData.marine[0].reg_id || '-'}</td></tr>
                            <tr><td>reg_sp</td><td>ì§€ì—­ êµ¬ë¶„</td><td>${currentData.marine[0].reg_sp || '-'}</td></tr>
                            <tr><td>reg_name</td><td>ì§€ì—­ëª…</td><td>${currentData.marine[0].reg_name || '-'}</td></tr>
                            <tr><td>wh_a</td><td>íŒŒê³  ë²”ìœ„ ì‹œì‘ (m)</td><td>${currentData.marine[0].wh_a || '-'}</td></tr>
                            <tr><td>wh_b</td><td>íŒŒê³  ë²”ìœ„ ë (m)</td><td>${currentData.marine[0].wh_b || '-'}</td></tr>
                            <tr><td>wf</td><td>ë‚ ì”¨ ì„¤ëª…</td><td>${currentData.marine[0].wf || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // Temper (medium-term temperature forecast)
            if (currentData.temper && currentData.temper.length > 0) {
                html += `
                    <div class="section-title">ğŸŒ¡ï¸ temper (ì¤‘ê¸° ê¸°ì˜¨ ì˜ˆë³´ - 4~11ì¼ì§¸)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.temper.length}ê°œ ë ˆì½”ë“œ</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>tm_ef_kr</td><td>ì˜ˆë³´ ìœ íš¨ ì‹œê° (KST)</td><td>${currentData.temper[0].tm_ef_kr || '-'}</td></tr>
                            <tr><td>reg_id</td><td>ì§€ì—­ ID</td><td>${currentData.temper[0].reg_id || '-'}</td></tr>
                            <tr><td>reg_sp</td><td>ì§€ì—­ êµ¬ë¶„</td><td>${currentData.temper[0].reg_sp || '-'}</td></tr>
                            <tr><td>reg_name</td><td>ì§€ì—­ëª…</td><td>${currentData.temper[0].reg_name || '-'}</td></tr>
                            <tr><td>min_temp</td><td>ìµœì € ê¸°ì˜¨ (Â°C)</td><td>${currentData.temper[0].min_temp || '-'}</td></tr>
                            <tr><td>max_temp</td><td>ìµœê³  ê¸°ì˜¨ (Â°C)</td><td>${currentData.temper[0].max_temp || '-'}</td></tr>
                            <tr><td>min_temp_l</td><td>ìµœì € ê¸°ì˜¨ í•˜í•œ (Â°C)</td><td>${currentData.temper[0].min_temp_l || '-'}</td></tr>
                            <tr><td>min_temp_h</td><td>ìµœì € ê¸°ì˜¨ ìƒí•œ (Â°C)</td><td>${currentData.temper[0].min_temp_h || '-'}</td></tr>
                            <tr><td>max_temp_l</td><td>ìµœê³  ê¸°ì˜¨ í•˜í•œ (Â°C)</td><td>${currentData.temper[0].max_temp_l || '-'}</td></tr>
                            <tr><td>max_temp_h</td><td>ìµœê³  ê¸°ì˜¨ ìƒí•œ (Â°C)</td><td>${currentData.temper[0].max_temp_h || '-'}</td></tr>
                            <tr><td>sky</td><td>í•˜ëŠ˜ ìƒíƒœ</td><td>${currentData.temper[0].sky || '-'}</td></tr>
                            <tr><td>pre</td><td>ê°•ìˆ˜ í™•ë¥ </td><td>${currentData.temper[0].pre || '-'}</td></tr>
                            <tr><td>wf</td><td>ë‚ ì”¨ ì„¤ëª…</td><td>${currentData.temper[0].wf || '-'}</td></tr>
                            <tr><td>rn_st</td><td>ê°•ìˆ˜ ìƒíƒœ ì½”ë“œ</td><td>${currentData.temper[0].rn_st || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            // OpenWeatherMap Forecast
            if (currentData.openweathermap && currentData.openweathermap.forecast && currentData.openweathermap.forecast.length > 0) {
                html += `
                    <div class="section-title">ğŸŒ¤ï¸ openweathermap.forecast (OpenWeatherMap ì˜ˆë³´)</div>
                    <p style="margin-bottom: 15px; color: #666;">ì´ ${currentData.openweathermap.forecast.length}ê°œ ë ˆì½”ë“œ (5ì¼ 3ì‹œê°„ ê°„ê²© + 8ì¼ ì¼ë³„)</p>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>í•„ë“œëª…</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒ˜í”Œ ê°’</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>forecast_date</td><td>ì˜ˆë³´ ë‚ ì§œ</td><td>${currentData.openweathermap.forecast[0].forecast_date || '-'}</td></tr>
                            <tr><td>forecast_time</td><td>ì˜ˆë³´ ì‹œê° (12:00:00=ì¼ë³„, ê·¸ ì™¸=3ì‹œê°„ ê°„ê²©)</td><td>${currentData.openweathermap.forecast[0].forecast_time || '-'}</td></tr>
                            <tr><td>weather_main</td><td>ë‚ ì”¨ ì£¼ ì¹´í…Œê³ ë¦¬</td><td>${currentData.openweathermap.forecast[0].weather_main || '-'}</td></tr>
                            <tr><td>weather_description</td><td>ë‚ ì”¨ ìƒíƒœ ì„¤ëª…</td><td>${currentData.openweathermap.forecast[0].weather_description || '-'}</td></tr>
                            <tr><td>weather_icon</td><td>ë‚ ì”¨ ì•„ì´ì½˜ ì½”ë“œ</td><td>${currentData.openweathermap.forecast[0].weather_icon || '-'}</td></tr>
                            <tr><td>temp</td><td>ê¸°ì˜¨ (Â°C)</td><td>${currentData.openweathermap.forecast[0].temp || '-'}</td></tr>
                            <tr><td>temp_min</td><td>ìµœì € ê¸°ì˜¨ (Â°C)</td><td>${currentData.openweathermap.forecast[0].temp_min || '-'}</td></tr>
                            <tr><td>temp_max</td><td>ìµœê³  ê¸°ì˜¨ (Â°C)</td><td>${currentData.openweathermap.forecast[0].temp_max || '-'}</td></tr>
                            <tr><td>humidity</td><td>ìŠµë„ (%)</td><td>${currentData.openweathermap.forecast[0].humidity || '-'}</td></tr>
                            <tr><td>wind_speed</td><td>í’ì† (m/s)</td><td>${currentData.openweathermap.forecast[0].wind_speed || '-'}</td></tr>
                            <tr><td>wind_deg</td><td>í’í–¥ (ë„)</td><td>${currentData.openweathermap.forecast[0].wind_deg || '-'}</td></tr>
                            <tr><td>pop</td><td>ê°•ìˆ˜ í™•ë¥  (0~1)</td><td>${currentData.openweathermap.forecast[0].pop || '-'}</td></tr>
                        </tbody>
                    </table>
                `;
            }

            fieldsViewer.innerHTML = html;
        }

        function switchTab(tabName) {
            // Update tab buttons
            const tabs = document.querySelectorAll('.tabs > .tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            const contents = document.querySelectorAll('.result-section > .tab-content');
            contents.forEach(content => content.classList.remove('active'));

            if (tabName === 'raw') {
                document.getElementById('rawTab').classList.add('active');
            } else {
                document.getElementById('fieldsTab').classList.add('active');
            }
        }

        function switchSubTab(subTabName) {
            // Update sub-tab buttons
            const subTabs = document.querySelectorAll('.sub-tab');
            subTabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update sub-tab content
            const subContents = document.querySelectorAll('.sub-tab-content');
            subContents.forEach(content => content.classList.remove('active'));

            if (subTabName === 'json') {
                document.getElementById('jsonSubTab').classList.add('active');
            } else {
                document.getElementById('formattedSubTab').classList.add('active');
            }
        }

        function clearResults() {
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('jsonViewer').textContent = '';
            document.getElementById('fieldsViewer').innerHTML = '';
            currentData = null;
        }

        function syntaxHighlight(json) {
            if (typeof json != 'string') {
                json = JSON.stringify(json, undefined, 2);
            }
            json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
            return json.replace(/(\"(\\u[a-zA-Z0-9]{4}|[^\\u]|\\.)*\"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
                var cls = 'number';
                if (/^\"/.test(match)) {
                    if (/:$/.test(match)) {
                        cls = 'key';
                    } else {
                        cls = 'string';
                    }
                } else if (/true|false/.test(match)) {
                    cls = 'boolean';
                } else if (/null/.test(match)) {
                    cls = 'null';
                }
                return '<span class="' + cls + '">' + match + '</span>';
            });
        }

        function formatJSONWithNavigation(data) {
            let html = '';
            let navItems = [];

            // Collect navigation items
            if (data.ads && data.ads.length > 0) navItems.push({id: 'json-ads', label: 'ğŸ¯ ê´‘ê³ ', count: data.ads.length});
            if (data.weather_forecasts && data.weather_forecasts.length > 0) navItems.push({id: 'json-weather-forecasts', label: 'â˜ï¸ ë‹¨ê¸°ì˜ˆë³´', count: data.weather_forecasts.length});
            if (data.tide_data && data.tide_data.length > 0) navItems.push({id: 'json-tide-data', label: 'ğŸŒŠ ì¡°ì„', count: data.tide_data.length});
            if (data.marine_observations && ((data.marine_observations.a && data.marine_observations.a.length > 0) || (data.marine_observations.b && data.marine_observations.b.length > 0))) navItems.push({id: 'json-marine-obs', label: 'ğŸŒŠ í•´ìƒê´€ì¸¡', count: (data.marine_observations.a?.length || 0) + (data.marine_observations.b?.length || 0)});
            if (data.marine && data.marine.length > 0) navItems.push({id: 'json-marine', label: 'ğŸŒŠ ì¤‘ê¸°í•´ìƒ', count: data.marine.length});
            if (data.temper && data.temper.length > 0) navItems.push({id: 'json-temper', label: 'ğŸŒ¡ï¸ ì¤‘ê¸°ê¸°ì˜¨', count: data.temper.length});
            if (data.openweathermap?.forecast && data.openweathermap.forecast.length > 0) navItems.push({id: 'json-owm-forecast', label: 'ğŸŒ¤ï¸ OWMì˜ˆë³´', count: data.openweathermap.forecast.length});

            // Sticky navigation
            if (navItems.length > 0) {
                html += '<div class="sticky-nav">';
                navItems.forEach(item => {
                    html += `<span class="nav-item" data-target="${item.id}" onclick="scrollToSection('${item.id}')">${item.label} (${item.count})</span>`;
                });
                html += '</div>';
            }

            // Create sections for each data type
            const sections = [];

            if (data.ads && data.ads.length > 0) {
                sections.push({
                    id: 'json-ads',
                    title: `ğŸ¯ ads (ê´‘ê³  ìº í˜ì¸ - ${data.ads.length}ê°œ)`,
                    data: { ads: data.ads }
                });
            }

            if (data.weather_forecasts && data.weather_forecasts.length > 0) {
                sections.push({
                    id: 'json-weather-forecasts',
                    title: `â˜ï¸ weather_forecasts (${data.weather_forecasts.length}ê°œ)`,
                    data: { weather_forecasts: data.weather_forecasts }
                });
            }

            if (data.tide_data && data.tide_data.length > 0) {
                sections.push({
                    id: 'json-tide-data',
                    title: `ğŸŒŠ tide_data (${data.tide_data.length}ê°œ)`,
                    data: { tide_data: data.tide_data }
                });
            }

            if (data.marine_observations && ((data.marine_observations.a && data.marine_observations.a.length > 0) || (data.marine_observations.b && data.marine_observations.b.length > 0))) {
                sections.push({
                    id: 'json-marine-obs',
                    title: `ğŸŒŠ marine_observations (a: ${data.marine_observations.a?.length || 0}ê°œ, b: ${data.marine_observations.b?.length || 0}ê°œ)`,
                    data: { marine_observations: data.marine_observations }
                });
            }

            if (data.marine && data.marine.length > 0) {
                sections.push({
                    id: 'json-marine',
                    title: `ğŸŒŠ marine (${data.marine.length}ê°œ)`,
                    data: { marine: data.marine }
                });
            }

            if (data.temper && data.temper.length > 0) {
                sections.push({
                    id: 'json-temper',
                    title: `ğŸŒ¡ï¸ temper (${data.temper.length}ê°œ)`,
                    data: { temper: data.temper }
                });
            }

            if (data.openweathermap?.forecast && data.openweathermap.forecast.length > 0) {
                sections.push({
                    id: 'json-owm-forecast',
                    title: `ğŸŒ¤ï¸ openweathermap.forecast (${data.openweathermap.forecast.length}ê°œ)`,
                    data: { forecast: data.openweathermap.forecast }
                });
            }

            // Render sections
            sections.forEach(section => {
                html += `<div class="data-section" id="${section.id}">`;
                html += `<div class="section-header" onclick="toggleSection('${section.id}')">`;
                html += `<h3 class="section-title">${section.title}</h3>`;
                html += `<span class="section-toggle">â–¼</span>`;
                html += `</div>`;
                html += `<div class="section-content"><div style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; line-height: 1.6; white-space: pre-wrap; overflow-x: auto;">`;
                html += syntaxHighlight(section.data);
                html += `</div></div></div>`;
            });

            if (sections.length === 0) {
                html = '<div class="json-viewer">' + syntaxHighlight(data) + '</div>';
            }

            return html;
        }

        function getSkyDescription(skyCode) {
            const descriptions = {
                '1': 'ë§‘ìŒ',
                '2': 'êµ¬ë¦„ì¡°ê¸ˆ',
                '3': 'êµ¬ë¦„ë§ìŒ',
                '4': 'íë¦¼'
            };
            return descriptions[skyCode] || skyCode;
        }

        function formatDataAsHTML(data) {
            let html = '';
            let navItems = [];

            // ìŠ¤í‹°í‚¤ ë„¤ë¹„ê²Œì´ì…˜ ì•„ì´í…œ ìˆ˜ì§‘
            if (data.ads && data.ads.length > 0) navItems.push({id: 'ads-data', label: 'ğŸ¯ ê´‘ê³ ', count: data.ads.length});
            if (data.weather_forecasts && data.weather_forecasts.length > 0) navItems.push({id: 'weather-forecasts', label: 'â˜ï¸ ë‹¨ê¸°ì˜ˆë³´', count: data.weather_forecasts.length});
            if (data.tide_data && data.tide_data.length > 0) navItems.push({id: 'tide-data', label: 'ğŸŒŠ ì¡°ì„', count: data.tide_data.length});
            if (data.marine_observations && ((data.marine_observations.a && data.marine_observations.a.length > 0) || (data.marine_observations.b && data.marine_observations.b.length > 0))) navItems.push({id: 'marine-obs', label: 'ğŸŒŠ í•´ìƒê´€ì¸¡', count: (data.marine_observations.a?.length || 0) + (data.marine_observations.b?.length || 0)});
            if (data.marine && data.marine.length > 0) navItems.push({id: 'marine', label: 'ğŸŒŠ ì¤‘ê¸°í•´ìƒ', count: data.marine.length});
            if (data.temper && data.temper.length > 0) navItems.push({id: 'temper', label: 'ğŸŒ¡ï¸ ì¤‘ê¸°ê¸°ì˜¨', count: data.temper.length});
            if (data.openweathermap?.forecast && data.openweathermap.forecast.length > 0) navItems.push({id: 'owm-forecast', label: 'ğŸŒ¤ï¸ OWMì˜ˆë³´', count: data.openweathermap.forecast.length});

            // ìŠ¤í‹°í‚¤ ë„¤ë¹„ê²Œì´ì…˜
            if (navItems.length > 0) {
                html += '<div class="sticky-nav">';
                navItems.forEach(item => {
                    html += `<span class="nav-item" data-target="${item.id}" onclick="scrollToSection('${item.id}')">${item.label} (${item.count})</span>`;
                });
                html += '</div>';
            }

            // ì„¹ì…˜ë³„ ë°ì´í„°
            html += formatDataAsText(data);

            return html;
        }

        function formatDataAsText(data) {
            let text = '';

            // Ad Data (ê´‘ê³  ë°ì´í„°)
            if (data.ads && data.ads.length > 0) {
                text += `<div class="data-section" id="ads-data">`;
                text += `<div class="section-header" onclick="toggleSection('ads-data')">`;
                text += `<h3 class="section-title">ğŸ¯ ê´‘ê³  ìº í˜ì¸ (${data.ads.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.ads.forEach((ad, index) => {
                    text += `\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                    text += `ê´‘ê³  #${index + 1} (ìš°ì„ ìˆœìœ„: ${ad.priority})\n`;
                    text += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
                    text += `ğŸ“¢ ìº í˜ì¸ ì •ë³´\n`;
                    text += `id: ${ad.id || 'N/A'}\n`;
                    text += `campaign_name(ìº í˜ì¸ëª…): ${ad.campaign_name || 'N/A'}\n`;
                    text += `partner_id(ì œíœ´ì‚¬ID): ${ad.partner_id || 'N/A'}\n`;
                    text += `partner_name(ì œíœ´ì‚¬ëª…): ${ad.partner_name || 'N/A'}\n`;
                    text += `\në§¤ì¹­ ì •ë³´\n`;
                    text += `matched_station_id(ê´€ì¸¡ì†Œ): ${ad.matched_station_id && Array.isArray(ad.matched_station_id) && ad.matched_station_id.length > 0 ? ad.matched_station_id.join(', ') : 'ì „ì²´'}\n`;
                    text += `matched_area(í•´ì—­): ${ad.matched_area || 'ì „ì²´'}\n`;
                    text += `\nê´‘ê³  ì†Œì¬\n`;
                    text += `ad_type_a: ${ad.ad_type_a || 'N/A'}\n`;
                    text += `ad_type_b: ${ad.ad_type_b || 'N/A'}\n`;
                    text += `image_a_url: ${ad.image_a_url || 'N/A'}\n`;
                    text += `image_b_url: ${ad.image_b_url || 'N/A'}\n`;
                    text += `landing_url: ${ad.landing_url || 'N/A'}\n`;
                    text += `\nê¸°íƒ€\n`;
                    text += `priority(ìš°ì„ ìˆœìœ„): ${ad.priority || 0}\n`;
                    text += `business_type(ì—…ì¢…): ${ad.business_type || 'N/A'}\n`;
                    text += `business_level(ë“±ê¸‰): ${ad.business_level || 'N/A'}\n`;
                });

                text += `\n</pre></div></div>`;
            }

            // Weather Forecasts (ê¸°ìƒì²­ ë‹¨ê¸° ì˜ˆë³´)
            if (data.weather_forecasts && Array.isArray(data.weather_forecasts) && data.weather_forecasts.length > 0) {
                text += `<div class="data-section" id="weather-forecasts">`;
                text += `<div class="section-header" onclick="toggleSection('weather-forecasts')">`;
                text += `<h3 class="section-title">â˜ï¸ ê¸°ìƒì²­ ë‹¨ê¸° ì˜ˆë³´ (${data.weather_forecasts.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.weather_forecasts.forEach(forecast => {
                    const datetime = forecast.fcst_datetime_kr || 'N/A';
                    text += `ğŸ“… ${datetime}\n`;

                    if (forecast.tmp !== undefined && forecast.tmp !== null) text += `tmp(ê¸°ì˜¨): ${forecast.tmp}Â°C\n`;
                    if (forecast.tmn !== undefined && forecast.tmn !== null) text += `tmn(ìµœì €ê¸°ì˜¨): ${forecast.tmn}Â°C\n`;
                    if (forecast.tmx !== undefined && forecast.tmx !== null) text += `tmx(ìµœê³ ê¸°ì˜¨): ${forecast.tmx}Â°C\n`;
                    if (forecast.uuu !== undefined && forecast.uuu !== null) text += `uuu(í’ì† ë™ì„œì„±ë¶„): ${forecast.uuu}m/s\n`;
                    if (forecast.vvv !== undefined && forecast.vvv !== null) text += `vvv(í’ì† ë‚¨ë¶ì„±ë¶„): ${forecast.vvv}m/s\n`;
                    if (forecast.vec !== undefined && forecast.vec !== null) text += `vec(í’í–¥): ${forecast.vec}Â°\n`;
                    if (forecast.wsd !== undefined && forecast.wsd !== null) text += `wsd(í’ì†): ${forecast.wsd}m/s\n`;

                    if (forecast.sky) {
                        const skyDesc = getSkyDescription(forecast.sky);
                        text += `sky(í•˜ëŠ˜ìƒíƒœ): ${forecast.sky} (${skyDesc})\n`;
                    }

                    if (forecast.pty !== undefined && forecast.pty !== null) {
                        const ptyDesc = {'0': 'ì—†ìŒ', '1': 'ë¹„', '2': 'ë¹„/ëˆˆ', '3': 'ëˆˆ', '4': 'ì†Œë‚˜ê¸°'}[forecast.pty] || forecast.pty;
                        text += `pty(ê°•ìˆ˜í˜•íƒœ): ${forecast.pty} (${ptyDesc})\n`;
                    }

                    if (forecast.pop !== undefined && forecast.pop !== null) text += `pop(ê°•ìˆ˜í™•ë¥ ): ${forecast.pop}%\n`;
                    if (forecast.wav !== undefined && forecast.wav !== null) text += `wav(íŒŒê³ ): ${forecast.wav}m\n`;
                    if (forecast.pcp) text += `pcp(ê°•ìˆ˜ëŸ‰): ${forecast.pcp}\n`;
                    if (forecast.reh !== undefined && forecast.reh !== null) text += `reh(ìŠµë„): ${forecast.reh}%\n`;
                    if (forecast.sno) text += `sno(ì‹ ì ì„¤): ${forecast.sno}\n`;

                    text += '\n';
                });
                text += `</pre></div></div>`;
            }

            // Tide Data (ì¡°ì„ ë°ì´í„°)
            if (data.tide_data && Array.isArray(data.tide_data) && data.tide_data.length > 0) {
                text += `<div class="data-section" id="tide-data">`;
                text += `<div class="section-header" onclick="toggleSection('tide-data')">`;
                text += `<h3 class="section-title">ğŸŒŠ ì¡°ì„ ë°ì´í„° (${data.tide_data.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.tide_data.forEach(tide => {
                    const date = tide.obs_date || 'N/A';
                    text += `ğŸ“… ${date}\n`;

                    if (tide.lvl1) text += `lvl1(1ì°¨ ì¡°ì„): ${tide.lvl1}\n`;
                    if (tide.lvl2) text += `lvl2(2ì°¨ ì¡°ì„): ${tide.lvl2}\n`;
                    if (tide.lvl3) text += `lvl3(3ì°¨ ì¡°ì„): ${tide.lvl3}\n`;
                    if (tide.lvl4) text += `lvl4(4ì°¨ ì¡°ì„): ${tide.lvl4}\n`;
                    if (tide.date_sun) text += `date_sun(ì¼ì¶œ/ì¼ëª°): ${tide.date_sun}\n`;
                    if (tide.date_moon) text += `date_moon(ì›”ì¶œ/ì›”ëª°): ${tide.date_moon}\n`;
                    if (tide.mool_normal) text += `mool_normal(ë¬¼ë•Œ): ${tide.mool_normal}\n`;
                    if (tide.mool7) text += `mool7(ìŒë ¥7ì¼ ë¬¼ë•Œ): ${tide.mool7}\n`;
                    if (tide.mool8) text += `mool8(ìŒë ¥8ì¼ ë¬¼ë•Œ): ${tide.mool8}\n`;

                    text += '\n';
                });
                text += `</pre></div></div>`;
            }

            // Marine Observations (í•´ìƒ ê´€ì¸¡ ë°ì´í„°)
            if (data.marine_observations && ((data.marine_observations.a && data.marine_observations.a.length > 0) || (data.marine_observations.b && data.marine_observations.b.length > 0))) {
                const totalCount = (data.marine_observations.a?.length || 0) + (data.marine_observations.b?.length || 0);
                text += `<div class="data-section" id="marine-obs">`;
                text += `<div class="section-header" onclick="toggleSection('marine-obs')">`;
                text += `<h3 class="section-title">ğŸŒŠ í•´ìƒ ê´€ì¸¡ ë°ì´í„° (${totalCount}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                // A ì„¹ì…˜ (ìˆ˜ì˜¨, íŒŒê³ )
                if (data.marine_observations.a && Array.isArray(data.marine_observations.a) && data.marine_observations.a.length > 0) {
                    text += `ğŸ’§ ìˆ˜ì˜¨ ë° íŒŒê³  ê´€ì¸¡ (${data.marine_observations.a.length}ê°œ)\n`;

                    data.marine_observations.a.forEach(obs => {
                        const obsTime = obs.observation_time_kst || 'N/A';
                        text += `observation_time_kst: ${obsTime}\n`;

                        const stationId = obs.station_id || 'N/A';
                        text += `station_id(ê´€ì¸¡ì†Œ): ${stationId}\n`;

                        const waveHeight = (obs.significant_wave_height !== undefined && obs.significant_wave_height !== null)
                            ? obs.significant_wave_height : 'N/A';
                        text += `significant_wave_height(íŒŒê³ ): ${waveHeight}m\n`;

                        const waterTemp = (obs.water_temperature !== undefined && obs.water_temperature !== null)
                            ? `${obs.water_temperature}Â°C` : 'N/A';
                        text += `water_temperature(ìˆ˜ì˜¨): ${waterTemp}\n`;

                        text += '\n';
                    });
                }

                // B ì„¹ì…˜ (ê¸°ìƒ)
                if (data.marine_observations.b && Array.isArray(data.marine_observations.b) && data.marine_observations.b.length > 0) {
                    text += `ğŸŒ¬ï¸ ê¸°ìƒ ê´€ì¸¡ (${data.marine_observations.b.length}ê°œ)\n`;

                    data.marine_observations.b.forEach(obs => {
                        const obsTime = obs.observation_time_kst || 'N/A';
                        text += `observation_time_kst: ${obsTime}\n`;

                        const stationId = obs.station_id || 'N/A';
                        text += `station_id(ê´€ì¸¡ì†Œ): ${stationId}\n`;

                        const airTemp = (obs.air_temperature !== undefined && obs.air_temperature !== null)
                            ? `${obs.air_temperature}Â°C` : 'N/A';
                        text += `air_temperature(ê¸°ì˜¨): ${airTemp}\n`;

                        const windDir = (obs.wind_direction !== undefined && obs.wind_direction !== null)
                            ? `${obs.wind_direction}Â°` : 'N/A';
                        text += `wind_direction(í’í–¥): ${windDir}\n`;

                        const windSpeed = (obs.wind_speed !== undefined && obs.wind_speed !== null)
                            ? `${obs.wind_speed}m/s` : 'N/A';
                        text += `wind_speed(í’ì†): ${windSpeed}\n`;

                        text += '\n';
                    });
                }
                text += `</pre></div></div>`;
            }

            // Marine (ì¤‘ê¸° í•´ìƒ ì˜ˆë³´)
            if (data.marine && Array.isArray(data.marine) && data.marine.length > 0) {
                text += `<div class="data-section" id="marine">`;
                text += `<div class="section-header" onclick="toggleSection('marine')">`;
                text += `<h3 class="section-title">ğŸŒŠ ì¤‘ê¸° í•´ìƒ ì˜ˆë³´ (${data.marine.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.marine.forEach(marine => {
                    const forecastTime = marine.tm_ef_kr || 'N/A';
                    text += `ğŸ“… ${forecastTime}\n`;

                    if (marine.reg_id) text += `reg_id(ì§€ì—­ì½”ë“œ): ${marine.reg_id}\n`;
                    if (marine.reg_sp) text += `reg_sp(ì§€ì—­êµ¬ë¶„): ${marine.reg_sp}\n`;
                    if (marine.reg_name) text += `reg_name(ì§€ì—­ëª…): ${marine.reg_name}\n`;

                    const whA = (marine.wh_a !== undefined && marine.wh_a !== null) ? marine.wh_a : 'N/A';
                    const whB = (marine.wh_b !== undefined && marine.wh_b !== null) ? marine.wh_b : 'N/A';
                    if (whA !== 'N/A' || whB !== 'N/A') {
                        text += `wh_a~wh_b(íŒŒê³ ): ${whA}~${whB}m\n`;
                    }

                    const wf = marine.wf || 'N/A';
                    text += `wf(ë‚ ì”¨ì˜ˆë³´): ${wf}\n`;

                    text += '\n';
                });
                text += `</pre></div></div>`;
            }

            // Temper (ì¤‘ê¸° ê¸°ì˜¨ ì˜ˆë³´)
            if (data.temper && Array.isArray(data.temper) && data.temper.length > 0) {
                text += `<div class="data-section" id="temper">`;
                text += `<div class="section-header" onclick="toggleSection('temper')">`;
                text += `<h3 class="section-title">ğŸŒ¡ï¸ ì¤‘ê¸° ê¸°ì˜¨ ì˜ˆë³´ (${data.temper.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.temper.forEach(temp => {
                    const forecastTime = temp.tm_ef_kr || 'N/A';
                    text += `ğŸ“… ${forecastTime}\n`;

                    if (temp.reg_id) text += `reg_id(ì§€ì—­ì½”ë“œ): ${temp.reg_id}\n`;
                    if (temp.reg_sp) text += `reg_sp(ì§€ì—­êµ¬ë¶„): ${temp.reg_sp}\n`;
                    if (temp.reg_name) text += `reg_name(ì§€ì—­ëª…): ${temp.reg_name}\n`;

                    if (temp.min_temp !== undefined && temp.min_temp !== null) text += `min_temp(ìµœì €ê¸°ì˜¨): ${temp.min_temp}Â°C\n`;
                    if (temp.max_temp !== undefined && temp.max_temp !== null) text += `max_temp(ìµœê³ ê¸°ì˜¨): ${temp.max_temp}Â°C\n`;
                    if (temp.min_temp_l !== undefined && temp.min_temp_l !== null) text += `min_temp_l(ìµœì €ê¸°ì˜¨ í•˜í•œ): ${temp.min_temp_l}Â°C\n`;
                    if (temp.min_temp_h !== undefined && temp.min_temp_h !== null) text += `min_temp_h(ìµœì €ê¸°ì˜¨ ìƒí•œ): ${temp.min_temp_h}Â°C\n`;
                    if (temp.max_temp_l !== undefined && temp.max_temp_l !== null) text += `max_temp_l(ìµœê³ ê¸°ì˜¨ í•˜í•œ): ${temp.max_temp_l}Â°C\n`;
                    if (temp.max_temp_h !== undefined && temp.max_temp_h !== null) text += `max_temp_h(ìµœê³ ê¸°ì˜¨ ìƒí•œ): ${temp.max_temp_h}Â°C\n`;

                    if (temp.sky) {
                        const skyDesc = getSkyDescription(temp.sky);
                        text += `sky(í•˜ëŠ˜ìƒíƒœ): ${temp.sky} (${skyDesc})\n`;
                    }

                    if (temp.wf) text += `wf(ë‚ ì”¨): ${temp.wf}\n`;
                    if (temp.pre) text += `pre(ê°•ìˆ˜): ${temp.pre}\n`;
                    if (temp.rn_st !== undefined && temp.rn_st !== null) text += `rn_st(ê°•ìˆ˜ìƒíƒœ): ${temp.rn_st}\n`;

                    text += '\n';
                });
                text += `</pre></div></div>`;
            }

            // OpenWeatherMap Forecast (ì˜ˆë³´)
            if (data.openweathermap && data.openweathermap.forecast && Array.isArray(data.openweathermap.forecast) && data.openweathermap.forecast.length > 0) {
                text += `<div class="data-section" id="owm-forecast">`;
                text += `<div class="section-header" onclick="toggleSection('owm-forecast')">`;
                text += `<h3 class="section-title">ğŸŒ¤ï¸ OpenWeatherMap ì˜ˆë³´ (${data.openweathermap.forecast.length}ê°œ)</h3>`;
                text += `<span class="section-toggle">â–¼</span>`;
                text += `</div>`;
                text += `<div class="section-content"><pre>`;

                data.openweathermap.forecast.forEach(forecast => {
                    const date = forecast.forecast_date || 'N/A';
                    const time = forecast.forecast_time || 'N/A';
                    const forecastType = time === '12:00:00' ? '(ì¼ë³„ ì˜ˆë³´)' : '(3ì‹œê°„ ì˜ˆë³´)';
                    text += `ğŸ“… ${date} ${time} ${forecastType}\n`;

                    if (forecast.weather_main) text += `weather_main(ë‚ ì”¨): ${forecast.weather_main}\n`;
                    if (forecast.weather_description) text += `weather_description(ìƒì„¸): ${forecast.weather_description}\n`;
                    if (forecast.weather_icon) text += `weather_icon(ì•„ì´ì½˜): ${forecast.weather_icon}\n`;
                    if (forecast.temp !== undefined && forecast.temp !== null) text += `temp(ê¸°ì˜¨): ${forecast.temp}Â°C\n`;
                    if (forecast.temp_min !== undefined && forecast.temp_min !== null) text += `temp_min(ìµœì €ê¸°ì˜¨): ${forecast.temp_min}Â°C\n`;
                    if (forecast.temp_max !== undefined && forecast.temp_max !== null) text += `temp_max(ìµœê³ ê¸°ì˜¨): ${forecast.temp_max}Â°C\n`;
                    if (forecast.humidity !== undefined && forecast.humidity !== null) text += `humidity(ìŠµë„): ${forecast.humidity}%\n`;
                    if (forecast.wind_speed !== undefined && forecast.wind_speed !== null) text += `wind_speed(í’ì†): ${forecast.wind_speed}m/s\n`;
                    if (forecast.wind_deg !== undefined && forecast.wind_deg !== null) text += `wind_deg(í’í–¥): ${forecast.wind_deg}Â°\n`;
                    if (forecast.pop !== undefined && forecast.pop !== null) text += `pop(ê°•ìˆ˜í™•ë¥ ): ${(forecast.pop * 100).toFixed(0)}%\n`;

                    text += '\n';
                });
                text += `</pre></div></div>`;
            }

            if (text === '') {
                text = 'í¬ë§·íŒ…í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
            }

            return text;
        }
        // iframe ì•ˆì—ì„œ ë¡œë“œë  ë•Œ í—¤ë”/ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        if (window.self !== window.top) {
            // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            const backButtons = document.querySelectorAll('.back-button, a[href="/"], a[href="index.html"]');
            backButtons.forEach(btn => btn.style.display = 'none');

            // í—¤ë” ìˆ¨ê¸°ê¸° (ë‹¤ì–‘í•œ ì„ íƒì ì‹œë„)
            const headers = document.querySelectorAll('.header, .hero, header');
            headers.forEach(header => {
                // í—¤ë” ë‚´ìš©ì´ "ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°"ë§Œ ìˆëŠ” ê²½ìš° ì „ì²´ ìˆ¨ê¹€
                if (header.querySelector('.back-button')) {
                    header.style.display = 'none';
                }
            });

            // ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì •ë¦¬
            const containers = document.querySelectorAll('.container, .dashboard');
            containers.forEach(container => {
                container.style.borderRadius = '0';
                container.style.boxShadow = 'none';
            });

            // body ë°°ê²½ ì •ë¦¬
            document.body.style.background = 'white';
            document.body.style.padding = '0';
            document.body.style.minHeight = 'auto';
        }

    </script>
</body>
</html>
