<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMA ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
            text-align: center;
            position: relative;
        }
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .header p {
            opacity: 0.9;
        }
        .back-button {
            position: absolute;
            top: 30px;
            left: 30px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .back-button:hover {
            background: rgba(255,255,255,0.3);
        }
        .content {
            padding: 30px;
        }
        .filters {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .filters h2 {
            color: #333;
            margin-bottom: 20px;
        }
        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        .filter-group label {
            margin-bottom: 5px;
            color: #555;
            font-weight: bold;
            font-size: 0.9em;
        }
        .filter-group input,
        .filter-group select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
        }
        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        .stats {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .table-container {
            overflow-x: auto;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            table-layout: auto;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: bold;
            vertical-align: top;
        }
        th .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
            margin-bottom: 8px;
            white-space: nowrap;
        }
        th .header-content:hover {
            opacity: 0.9;
        }
        th .sort-icon {
            margin-left: 5px;
            font-size: 0.8em;
            opacity: 0.5;
        }
        th.sorted-asc .sort-icon::after {
            content: 'â–²';
            opacity: 1;
        }
        th.sorted-desc .sort-icon::after {
            content: 'â–¼';
            opacity: 1;
        }
        th .filter-input {
            width: 100%;
            padding: 5px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 4px;
            font-size: 0.85em;
            box-sizing: border-box;
            background: rgba(255,255,255,0.9);
            color: #333;
        }
        th .filter-input:focus {
            outline: none;
            border-color: #fff;
            background: #fff;
        }
        th .filter-input::placeholder {
            color: #999;
        }
        td {
            padding: 12px 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        tr:hover {
            background: #f8f9fa;
        }
        .data-indicator {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .data-available {
            background: #28a745;
            color: white;
        }
        .data-missing {
            background: #dc3545;
            color: white;
        }
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        .pagination button {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .pagination button:hover:not(:disabled) {
            background: #667eea;
            color: white;
        }
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .pagination span {
            color: #333;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-button">â† ëŒ€ì‹œë³´ë“œ</a>
            <h1>ğŸŒŠ KMA ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸</h1>
            <p>ê¸°ìƒì²­ í•´ì–‘ê´€ì¸¡ ë°ì´í„° ìˆ˜ì§‘ í˜„í™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”</p>
        </div>

        <div class="content">
            <!-- í•„í„° ì„¹ì…˜ -->
            <div class="filters">
                <h2>ğŸ” í•„í„° ê²€ìƒ‰</h2>
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="stationName">ì§€ì ëª…</label>
                        <input type="text" id="stationName" placeholder="ì˜ˆ: ë•ì ë„">
                    </div>
                    <div class="filter-group">
                        <label for="stationId">ì§€ì  ID</label>
                        <input type="number" id="stationId" placeholder="ì˜ˆ: 22101">
                    </div>
                    <div class="filter-group">
                        <label for="observationType">ê´€ì¸¡ íƒ€ì…</label>
                        <select id="observationType">
                            <option value="">ì „ì²´</option>
                            <option value="BUOY">BUOY (ë¶€ì´)</option>
                            <option value="TW">TW (ì¡°ìœ„)</option>
                            <option value="AWS">AWS (ìë™ê¸°ìƒ)</option>
                            <option value="LIGHTHOUSE">LIGHTHOUSE (ë“±ëŒ€)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="dateFilter">ë‚ ì§œ</label>
                        <input type="date" id="dateFilter">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="loadData()">ê²€ìƒ‰</button>
                    <button class="btn btn-secondary" onclick="resetFilters()">ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- í†µê³„ ì„¹ì…˜ -->
            <div class="stats" id="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalRecords">-</div>
                    <div class="stat-label">ì´ ë ˆì½”ë“œ ìˆ˜</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalStations">-</div>
                    <div class="stat-label">ê´€ì¸¡ ì§€ì  ìˆ˜</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="lastUpdate">-</div>
                    <div class="stat-label">ìµœê·¼ ìˆ˜ì§‘ ì‹œê°„</div>
                </div>
            </div>

            <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
            <div id="errorMessage" class="error" style="display: none;"></div>

            <!-- ë¡œë”© í‘œì‹œ -->
            <div id="loading" class="loading" style="display: none;">
                ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>

            <!-- í…Œì´ë¸” ì„¹ì…˜ -->
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th data-column="request_time">
                                <div class="header-content" onclick="sortTable('request_time')">
                                    <span>ìš”ì²­ì‹œê°„</span>
                                    <span class="sort-icon"></span>
                                </div>
                                <input type="text" class="filter-input" id="filter_request_time" placeholder="í•„í„°..." onkeyup="applyFilters()" onclick="event.stopPropagation()">
                            </th>
                            <th data-column="observation_time_kst">
                                <div class="header-content" onclick="sortTable('observation_time_kst')">
                                    <span>ê´€ì¸¡ì‹œê°„(KST)</span>
                                    <span class="sort-icon"></span>
                                </div>
                                <input type="text" class="filter-input" id="filter_observation_time_kst" placeholder="í•„í„°..." onkeyup="applyFilters()" onclick="event.stopPropagation()">
                            </th>
                            <th data-column="station_name">
                                <div class="header-content" onclick="sortTable('station_name')">
                                    <span>ì§€ì ëª…</span>
                                    <span class="sort-icon"></span>
                                </div>
                                <input type="text" class="filter-input" id="filter_station_name" placeholder="í•„í„°..." onkeyup="applyFilters()" onclick="event.stopPropagation()">
                            </th>
                            <th data-column="station_id">
                                <div class="header-content" onclick="sortTable('station_id')">
                                    <span>ì§€ì ID</span>
                                    <span class="sort-icon"></span>
                                </div>
                                <input type="text" class="filter-input" id="filter_station_id" placeholder="í•„í„°..." onkeyup="applyFilters()" onclick="event.stopPropagation()">
                            </th>
                            <th data-column="observation_type">
                                <div class="header-content" onclick="sortTable('observation_type')">
                                    <span>ê´€ì¸¡íƒ€ì…</span>
                                    <span class="sort-icon"></span>
                                </div>
                                <input type="text" class="filter-input" id="filter_observation_type" placeholder="í•„í„°..." onkeyup="applyFilters()" onclick="event.stopPropagation()">
                            </th>
                            <th>íŒŒê³ </th>
                            <th>í’í–¥</th>
                            <th>í’ì†</th>
                            <th>ëŒí’</th>
                            <th>ìˆ˜ì˜¨</th>
                            <th>ê¸°ì˜¨</th>
                            <th>ê¸°ì••</th>
                            <th>ìŠµë„</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td colspan="13" style="text-align: center; padding: 40px;">
                                ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- í˜ì´ì§• -->
            <div class="pagination" id="pagination" style="display: none;">
                <button id="prevPage" onclick="prevPage()">ì´ì „</button>
                <span id="pageInfo">1 / 1</span>
                <button id="nextPage" onclick="nextPage()">ë‹¤ìŒ</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Supabase ì„¤ì • (ë‹¤ë¥¸ í˜ì´ì§€ë“¤ê³¼ ë™ì¼í•œ í”„ë¡œì íŠ¸ ì‚¬ìš©)
        const SUPABASE_URL = 'https://iwpgvdtfpwazzfeniusk.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3cGd2ZHRmcHdhenpmZW5pdXNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEwNzEzOTQsImV4cCI6MjA2NjY0NzM5NH0.d0pjIvnOdPGbc_-cfqRNu9yOIutyO1eex848k1yNZJE';

        const { createClient } = supabase;
        const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // í˜ì´ì§• ë³€ìˆ˜
        let currentPage = 1;
        const itemsPerPage = 50;
        let totalPages = 1;
        let currentData = [];
        let filteredData = [];
        let allData = []; // ì „ì²´ ë°ì´í„° ì €ì¥

        // ì •ë ¬ ìƒíƒœ
        let currentSort = {
            column: 'request_time',
            direction: 'desc'
        };

        // ë‚ ì§œ í•„í„° ì´ˆê¸°ê°’ ì„¤ì • (ì˜¤ëŠ˜)
        document.getElementById('dateFilter').valueAsDate = new Date();

        // ë°ì´í„° ë¡œë“œ
        async function loadData(page = 1) {
            try {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('errorMessage').style.display = 'none';

                currentPage = page;

                // í•„í„° ê°’ ê°€ì ¸ì˜¤ê¸°
                const stationName = document.getElementById('stationName').value.trim();
                const stationId = document.getElementById('stationId').value.trim();
                const observationType = document.getElementById('observationType').value;
                const dateFilter = document.getElementById('dateFilter').value;

                // í•„í„° ê°’ ê°€ì ¸ì˜¤ê¸° (UTC ê¸°ì¤€ìœ¼ë¡œ ëª…ì‹œì  ì²˜ë¦¬)
                const startOfDay = dateFilter ? new Date(dateFilter + 'T00:00:00Z') : null;
                const endOfDay = dateFilter ? new Date(dateFilter + 'T23:59:59.999Z') : null;

                // í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ ì „ì²´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                allData = [];
                let offset = 0;
                const limit = 1000;
                let hasMore = true;

                while (hasMore) {
                    // ì¿¼ë¦¬ ìƒì„±
                    let query = supabaseClient
                        .from('abs_fetch_log')
                        .select('*')
                        .order('request_time', { ascending: false })
                        .range(offset, offset + limit - 1);

                    // ì„œë²„ ì‚¬ì´ë“œ í•„í„° ì ìš©
                    if (stationName) {
                        query = query.ilike('station_name', `%${stationName}%`);
                    }
                    if (stationId) {
                        query = query.eq('station_id', parseInt(stationId));
                    }
                    if (observationType) {
                        query = query.eq('observation_type', observationType);
                    }
                    if (dateFilter) {
                        query = query
                            .gte('request_time', startOfDay.toISOString())
                            .lte('request_time', endOfDay.toISOString());
                    }

                    const { data, error } = await query;

                    if (error) throw error;

                    const pageData = data || [];
                    allData = allData.concat(pageData);

                    console.log(`í˜ì´ì§€ ${Math.floor(offset / limit) + 1}: ${pageData.length}ê°œ ì¡°íšŒ, ëˆ„ì : ${allData.length}ê°œ`);

                    if (pageData.length < limit) {
                        hasMore = false;
                    } else {
                        offset += limit;
                    }
                }

                // í†µê³„ ì—…ë°ì´íŠ¸
                await updateStats();

                // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ í•„í„° ë° ì •ë ¬ ì ìš©
                applyFilters();

            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('errorMessage').textContent = `ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}`;
                document.getElementById('errorMessage').style.display = 'block';
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // í…Œì´ë¸” ì •ë ¬
        function sortTable(column) {
            // ì •ë ¬ ë°©í–¥ í† ê¸€
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            // ì •ë ¬ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
            document.querySelectorAll('th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
            });
            const th = document.querySelector(`th[data-column="${column}"]`);
            if (th) {
                th.classList.add(`sorted-${currentSort.direction}`);
            }

            // ë°ì´í„° ì •ë ¬ ë° ë Œë”ë§
            applyFilters();
        }

        // í•„í„° ì ìš©
        function applyFilters() {
            // í…Œì´ë¸” í—¤ë” í•„í„° ê°’ ê°€ì ¸ì˜¤ê¸°
            const filters = {
                request_time: document.getElementById('filter_request_time')?.value.toLowerCase() || '',
                observation_time_kst: document.getElementById('filter_observation_time_kst')?.value.toLowerCase() || '',
                station_name: document.getElementById('filter_station_name')?.value.toLowerCase() || '',
                station_id: document.getElementById('filter_station_id')?.value.toLowerCase() || '',
                observation_type: document.getElementById('filter_observation_type')?.value.toLowerCase() || ''
            };

            // í•„í„°ë§
            filteredData = allData.filter(row => {
                const requestTimeStr = new Date(row.request_time).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' }).toLowerCase();

                return (
                    (!filters.request_time || requestTimeStr.includes(filters.request_time)) &&
                    (!filters.observation_time_kst || (row.observation_time_kst || '').toLowerCase().includes(filters.observation_time_kst)) &&
                    (!filters.station_name || (row.station_name || '').toLowerCase().includes(filters.station_name)) &&
                    (!filters.station_id || String(row.station_id).includes(filters.station_id)) &&
                    (!filters.observation_type || (row.observation_type || '').toLowerCase().includes(filters.observation_type))
                );
            });

            // ì •ë ¬
            filteredData.sort((a, b) => {
                let aVal = a[currentSort.column];
                let bVal = b[currentSort.column];

                // null/undefined ì²˜ë¦¬
                if (aVal == null) aVal = '';
                if (bVal == null) bVal = '';

                // ìˆ«ìí˜• ë¹„êµ
                if (currentSort.column === 'station_id') {
                    aVal = Number(aVal) || 0;
                    bVal = Number(bVal) || 0;
                }

                // ë¹„êµ
                if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                return 0;
            });

            // í˜ì´ì§• ê³„ì‚°
            totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage > totalPages) currentPage = 1;

            // í˜„ì¬ í˜ì´ì§€ ë°ì´í„° ì¶”ì¶œ
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            currentData = filteredData.slice(start, end);

            // í…Œì´ë¸” ë Œë”ë§
            renderTable(currentData);

            // í˜ì´ì§• ì—…ë°ì´íŠ¸
            updatePagination(filteredData.length);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        async function updateStats() {
            try {
                // ì´ ë ˆì½”ë“œ ìˆ˜
                const { count: totalCount } = await supabaseClient
                    .from('abs_fetch_log')
                    .select('*', { count: 'exact', head: true });

                document.getElementById('totalRecords').textContent = totalCount || 0;

                // ê´€ì¸¡ ì§€ì  ìˆ˜
                const { data: stationData } = await supabaseClient
                    .from('abs_fetch_log')
                    .select('station_id');

                const uniqueStations = new Set(stationData?.map(d => d.station_id) || []);
                document.getElementById('totalStations').textContent = uniqueStations.size;

                // ìµœê·¼ ìˆ˜ì§‘ ì‹œê°„
                const { data: latestData } = await supabaseClient
                    .from('abs_fetch_log')
                    .select('request_time')
                    .order('request_time', { ascending: false })
                    .limit(1)
                    .single();

                if (latestData) {
                    const date = new Date(latestData.request_time);
                    document.getElementById('lastUpdate').textContent =
                        date.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' });
                }

            } catch (error) {
                console.error('Error updating stats:', error);
            }
        }

        // í…Œì´ë¸” ë Œë”ë§
        function renderTable(data) {
            const tbody = document.getElementById('tableBody');

            if (!data || data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="13" style="text-align: center; padding: 40px;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                return;
            }

            tbody.innerHTML = data.map(row => {
                const requestTime = new Date(row.request_time);
                const requestTimeStr = requestTime.toLocaleString('ko-KR', {
                    timeZone: 'Asia/Seoul',
                    year: '2-digit',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                return `
                    <tr>
                        <td>${requestTimeStr}</td>
                        <td>${row.observation_time_kst || '-'}</td>
                        <td>${row.station_name || '-'}</td>
                        <td>${row.station_id}</td>
                        <td>${row.observation_type || '-'}</td>
                        <td>${renderIndicator(row.significant_wave_height_available)}</td>
                        <td>${renderIndicator(row.wind_direction_available)}</td>
                        <td>${renderIndicator(row.wind_speed_available)}</td>
                        <td>${renderIndicator(row.gust_wind_speed_available)}</td>
                        <td>${renderIndicator(row.water_temperature_available)}</td>
                        <td>${renderIndicator(row.air_temperature_available)}</td>
                        <td>${renderIndicator(row.pressure_available)}</td>
                        <td>${renderIndicator(row.humidity_available)}</td>
                    </tr>
                `;
            }).join('');
        }

        // ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ í‘œì‹œ
        function renderIndicator(available) {
            if (available) {
                return '<span class="data-indicator data-available">O</span>';
            } else {
                return '<span class="data-indicator data-missing">X</span>';
            }
        }

        // í˜ì´ì§• ì—…ë°ì´íŠ¸
        function updatePagination(totalCount) {
            const pagination = document.getElementById('pagination');
            const pageInfo = document.getElementById('pageInfo');
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');

            if (totalCount > 0) {
                pagination.style.display = 'flex';
                pageInfo.textContent = `${currentPage} / ${totalPages}`;
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages;
            } else {
                pagination.style.display = 'none';
            }
        }

        // ì´ì „ í˜ì´ì§€
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                applyFilters();
            }
        }

        // ë‹¤ìŒ í˜ì´ì§€
        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
                applyFilters();
            }
        }

        // í•„í„° ì´ˆê¸°í™”
        function resetFilters() {
            document.getElementById('stationName').value = '';
            document.getElementById('stationId').value = '';
            document.getElementById('observationType').value = '';
            document.getElementById('dateFilter').valueAsDate = new Date();

            // í…Œì´ë¸” í—¤ë” í•„í„° ì´ˆê¸°í™”
            document.getElementById('filter_request_time').value = '';
            document.getElementById('filter_observation_time_kst').value = '';
            document.getElementById('filter_station_name').value = '';
            document.getElementById('filter_station_id').value = '';
            document.getElementById('filter_observation_type').value = '';

            loadData(1);
        }

        // ì—”í„°í‚¤ë¡œ ê²€ìƒ‰
        document.querySelectorAll('.filter-group input, .filter-group select').forEach(element => {
            element.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loadData(1);
                }
            });
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í†µê³„ë§Œ ì—…ë°ì´íŠ¸
        window.addEventListener('load', () => {
            updateStats();
        });
        // iframe ì•ˆì—ì„œ ë¡œë“œë  ë•Œ í—¤ë”/ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        if (window.self !== window.top) {
            // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            const backButtons = document.querySelectorAll('.back-button, a[href="/"], a[href="index.html"]');
            backButtons.forEach(btn => btn.style.display = 'none');

            // í—¤ë” ìˆ¨ê¸°ê¸° (ë‹¤ì–‘í•œ ì„ íƒì ì‹œë„)
            const headers = document.querySelectorAll('.header, .hero, header');
            headers.forEach(header => {
                // í—¤ë” ë‚´ìš©ì´ "ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°"ë§Œ ìˆëŠ” ê²½ìš° ì „ì²´ ìˆ¨ê¹€
                if (header.querySelector('.back-button')) {
                    header.style.display = 'none';
                }
            });

            // ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì •ë¦¬
            const containers = document.querySelectorAll('.container, .dashboard');
            containers.forEach(container => {
                container.style.borderRadius = '0';
                container.style.boxShadow = 'none';
            });

            // body ë°°ê²½ ì •ë¦¬
            document.body.style.background = 'white';
            document.body.style.padding = '0';
            document.body.style.minHeight = 'auto';
        }

    </script>
</body>
</html>
